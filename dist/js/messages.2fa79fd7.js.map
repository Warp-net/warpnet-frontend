{"version":3,"file":"js/messages.2fa79fd7.js","mappings":"8HACA,IAAIA,EAAI,EAAQ,MACZC,EAAO,EAAQ,MACfC,EAAU,EAAQ,MAClBC,EAAY,EAAQ,MACpBC,EAAW,EAAQ,MACnBC,EAAoB,EAAQ,MAC5BC,EAAgB,EAAQ,MACxBC,EAA2C,EAAQ,MAEnDC,EAAiCD,EAAyC,OAAQE,WAItFT,EAAE,CAAEU,OAAQ,WAAYC,OAAO,EAAMC,MAAM,EAAMC,OAAQL,GAAkC,CACzFM,KAAM,SAAcC,GAClBX,EAASY,MACT,IACEb,EAAUY,EACZ,CAAE,MAAOE,GACPX,EAAcU,KAAM,QAASC,EAC/B,CAEA,GAAIT,EAAgC,OAAOP,EAAKO,EAAgCQ,KAAMD,GAEtF,IAAIG,EAASb,EAAkBW,MAC3BG,EAAU,EACd,OAAOjB,EAAQgB,GAAQ,SAAUE,EAAOC,GACtC,GAAIN,EAAUK,EAAOD,KAAY,OAAOE,EAAKD,EAC/C,GAAG,CAAEE,WAAW,EAAMC,aAAa,IAAQC,MAC7C,G,4GCNKC,GAAG,MAAMC,MAAM,sB,GAKbA,MAAM,kF,GACJA,MAAM,uD,SASsBA,MAAM,mD,iBAS9BA,MAAM,yD,GACJA,MAAM,Q,aAMNA,MAAM,mB,GACJA,MAAM,qB,GACNA,MAAM,0B,GACNA,MAAM,mD,GAGNA,MAAM,6B,GAIRA,MAAM,oB,SAQYA,MAAM,oE,GAC9BA,MAAM,qB,SAekBA,MAAM,wC,GAE9BA,MAAM,6E,GAIJA,MAAM,Q,aAMNA,MAAM,iB,GACLA,MAAM,a,GACPA,MAAM,qB,GAMRA,MAAM,mD,GACJA,MAAM,yB,GACJC,IAAI,c,SAGgDD,MAAM,yB,GACtDA,MAAM,4E,GAGRA,MAAM,0B,SAGCA,MAAM,yB,aAKXA,MAAM,+E,GAGRA,MAAM,0B,GAOZA,MAAM,gE,oMAhHfE,EAAAA,EAAAA,IA2IM,MA3INC,EA2IM,EAzIJC,EAAAA,EAAAA,IAAWC,IAGXC,EAAAA,EAAAA,IAyCM,MAzCNC,EAyCM,EAxCJD,EAAAA,EAAAA,IAIM,MAJNE,EAIM,cAHJF,EAAAA,EAAAA,IAA+C,MAA3CN,MAAM,4BAA2B,SAAK,iBAC1CM,EAAAA,EAAAA,IAA2D,KAAxDN,MAAM,+CAA6C,WACtDM,EAAAA,EAAAA,IAA8F,KAA1FG,QAAKC,EAAA,KAAAA,EAAA,GAAAC,GAAEC,EAAAC,cAAcb,MAAM,gEAGjCI,EAAAA,EAAAA,IAA6BU,EAAA,CAApBC,QAASC,EAAAD,SAAO,oBAERC,EAAAD,S,iBAAO,WAAxBb,EAAAA,EAAAA,IA+BWe,EAAAA,GAAA,CAAAC,IAAA,IA9BmB,IAAjBF,EAAAG,MAAMC,SAAM,WAAvBlB,EAAAA,EAAAA,IAGM,MAHNmB,EAGMX,EAAA,KAAAA,EAAA,KAFJJ,EAAAA,EAAAA,IAA6C,KAA1CN,MAAM,qBAAoB,gBAAY,IACzCM,EAAAA,EAAAA,IAAuE,KAApEN,MAAM,qBAAoB,0CAAsC,sCAGrEE,EAAAA,EAAAA,IAwBMe,EAAAA,GAAA,MAAAK,EAAAA,EAAAA,IAxBcN,EAAAG,OAARI,K,WAAZrB,EAAAA,EAAAA,IAwBM,OAxBsBgB,IAAKK,EAAKxB,GACjCC,OAAKwB,EAAAA,EAAAA,IAAA,CAAC,iBACED,EAAKxB,KAAOiB,EAAAS,QAAQ1B,GAAK,yBAA2B,KAC3DU,QAAKE,GAAEC,EAAAc,WAAWH,I,EACtBjB,EAAAA,EAAAA,IAmBM,MAnBNqB,EAmBM,EAlBJrB,EAAAA,EAAAA,IAKM,MALNsB,EAKM,EAJJtB,EAAAA,EAAAA,IAGE,OAFGuB,IAAKjB,EAAAkB,QAAQP,EAAKQ,gBAAgBC,QAAU,sBAC7ChC,MAAM,0B,aAGZM,EAAAA,EAAAA,IAWM,MAXN2B,EAWM,EAVJ3B,EAAAA,EAAAA,IAQM,MARN4B,EAQM,EAPJ5B,EAAAA,EAAAA,IAAgG,IAAhG6B,GAAgGC,EAAAA,EAAAA,IAA3DxB,EAAAkB,QAAQP,EAAKQ,gBAAgBM,UAAY,aAAJ,IAC1E/B,EAAAA,EAAAA,IAEI,IAFJgC,EAA2D,MACxDF,EAAAA,EAAAA,IAAGb,EAAKQ,eAAa,IAExBzB,EAAAA,EAAAA,IAEI,IAFJiC,GAEIH,EAAAA,EAAAA,IADCI,EAAAC,SAASC,QAAQnB,EAAKoB,aAAU,2BAGvCzC,EAAAA,EAAAA,IAAuE,IAAvE0C,EAAuE,mBAA9BrB,EAAKsB,cAAgB,IAAJ,2B,cAQzD7B,EAAAD,UAAYC,EAAAS,SAAM,WAA7BvB,EAAAA,EAAAA,IAaM,MAbN4C,EAaM,EAZJxC,EAAAA,EAAAA,IAWM,MAXNyC,EAWM,gBAVJzC,EAAAA,EAAAA,IAAkE,KAA/DN,MAAM,qBAAoB,qCAAiC,mBAC9DM,EAAAA,EAAAA,IAEI,KAFDN,MAAM,0BAAyB,qEAElC,KACAM,EAAAA,EAAAA,IAKS,UAJJG,QAAKC,EAAA,KAAAA,EAAA,GAAAC,GAAEC,EAAAC,cACRb,MAAM,kFACT,uBAED,gBAKQgB,EAAAD,SAAWC,EAAAS,SAAM,WAA7BvB,EAAAA,EAAAA,IAiEM,MAjEN8C,EAiEM,EA/DJ1C,EAAAA,EAAAA,IAeM,MAfN2C,EAeM,EAdJ3C,EAAAA,EAAAA,IAES,UAFAG,QAAKC,EAAA,KAAAA,EAAA,GAAAC,GAAEC,EAAAsC,YAAYlD,MAAM,2C,gBAChCM,EAAAA,EAAAA,IAA2C,KAAxCN,MAAM,+BAA6B,aAExCM,EAAAA,EAAAA,IAKM,MALN6C,EAKM,EAJJ7C,EAAAA,EAAAA,IAGE,OAFGuB,IAAKjB,EAAAkB,QAAQd,EAAAS,OAAOM,gBAAgBC,QAAU,sBAC/ChC,MAAM,wB,aAGZM,EAAAA,EAAAA,IAGM,MAHN8C,EAGM,EAFJ9C,EAAAA,EAAAA,IAAwE,KAAxE+C,GAAwEjB,EAAAA,EAAAA,IAA/CxB,EAAAkB,QAAQd,EAAAS,OAAOM,gBAAgBM,UAAQ,IAChE/B,EAAAA,EAAAA,IAA4D,IAA5DgD,EAA6B,KAAClB,EAAAA,EAAAA,IAAGpB,EAAAS,OAAOM,eAAa,oBAEvDzB,EAAAA,EAAAA,IAA2E,KAAxEN,MAAM,+DAA6D,kCAIxEE,EAAAA,EAAAA,IAwBM,MAxBNqD,EAwBM,EAvBJjD,EAAAA,EAAAA,IAsBM,MAtBNkD,EAsBM,EArBJlD,EAAAA,EAAAA,IAA4B,MAA5BmD,EAA4B,yBAC5BvD,EAAAA,EAAAA,IAmBMe,EAAAA,GAAA,MAAAK,EAAAA,EAAAA,IAnBiBN,EAAA0C,UAAXC,K,WAAZzD,EAAAA,EAAAA,IAmBM,OAnB4BgB,IAAKyC,EAAQ5D,I,CAElC4D,EAAQC,YAAc5C,EAAA6C,aAAaC,UAAO,WAArD5D,EAAAA,EAAAA,IAKM,MALN6D,EAKM,EAJJzD,EAAAA,EAAAA,IAEM,MAFN0D,GAEM5B,EAAAA,EAAAA,IADDuB,EAAQM,MAAI,IAEjB3D,EAAAA,EAAAA,IAA6E,IAA7E4D,GAA6E9B,EAAAA,EAAAA,IAAxCI,EAAAC,SAAS0B,KAAKR,EAAQS,aAAU,mBAGvElE,EAAAA,EAAAA,IASM,MATNmE,EASM,EARJ/D,EAAAA,EAAAA,IAGE,OAFGuB,IAAKjB,EAAAkB,QAAQd,EAAAS,OAAOM,gBAAgBC,QAAU,sBAC/ChC,MAAM,6B,WAEVM,EAAAA,EAAAA,IAEM,MAFNgE,GAEMlC,EAAAA,EAAAA,IADDuB,EAAQM,MAAI,IAEjB3D,EAAAA,EAAAA,IAA6E,IAA7EiE,GAA6EnC,EAAAA,EAAAA,IAAxCI,EAAAC,SAAS0B,KAAKR,EAAQS,aAAU,W,eApBFxD,EAAA4D,SAAL,UA2BtElE,EAAAA,EAAAA,IAiBM,MAjBNmE,EAiBM,WAhBJnE,EAAAA,EAAAA,IAOE,S,qCANWU,EAAAiD,KAAItD,GACb+D,KAAK,SACL1E,MAAM,kHACN2E,YAAY,sBACXC,QAAKlE,EAAA,KAAAA,EAAA,IAAAmE,EAAAA,EAAAA,KAAA,IAAAC,IAAQlE,EAAAmE,aAAAnE,EAAAmE,eAAAD,IAAW,YACxBE,SAAUhE,EAAAgE,U,kBALFhE,EAAAiD,SAOb3D,EAAAA,EAAAA,IAOS,UANJG,QAAKC,EAAA,KAAAA,EAAA,OAAAoE,IAAElE,EAAAmE,aAAAnE,EAAAmE,eAAAD,IACPE,SAAUhE,EAAAgE,WAAahE,EAAAiD,KAAK7C,OAC7BpB,OAAKwB,EAAAA,EAAAA,IAAA,CAAC,+CACkB,IAAhBR,EAAAiD,KAAK7C,OAAe,4BAA8B,wB,gBAE5Dd,EAAAA,EAAAA,IAAoD,KAAjDN,MAAM,wCAAsC,sCAQ3CgB,EAAAiE,sBAAmB,WAF7BC,EAAAA,EAAAA,IAKEC,EAAA,C,MAJGC,UAAWpE,EAAAS,QAAQM,cAEZkD,oBAAqBjE,EAAAiE,oB,8CAAAjE,EAAAiE,oBAAmBtE,GAC/C0E,WAAUzE,EAAA0E,U,kGAUnB,GACEC,KAAM,WACNC,WAAY,CACVC,SAASC,EAAAA,EAAAA,KAAqB,IAAM,gCACpCC,QAAQD,EAAAA,EAAAA,KAAqB,IAAM,gCACnCE,mBAAmBF,EAAAA,EAAAA,KAAqB,IAAM,iCAEhDG,IAAAA,GACE,MAAO,CACL9E,SAAS,EACTiE,UAAU,EACVC,qBAAqB,EACrB9D,MAAO,GACPuC,SAAU,GACVG,kBAAciC,EACdrE,YAAQqE,EACR7B,KAAM,GACN8B,SAAU,IAAIC,IACdC,eAAWH,EAEf,EACAI,QAAS,CACPrF,UAAAA,GACEvB,KAAK2F,qBAAsB,CAC7B,EACA/B,QAAAA,GACE5D,KAAK6G,QAAQC,KAAK,CAChBb,KAAM,QAEV,EACA,iBAAMR,GACJ,IAAKzF,KAAKmC,OAAOM,eAAsC,IAArBzC,KAAK2E,KAAK7C,OAAc,OAC1D9B,KAAK0F,UAAW,EAEhB,MAAMrB,QAAgB0C,EAAAA,GAAeC,kBAAkB,CACrDC,OAAQjH,KAAKmC,OAAO1B,GACpByG,WAAYlH,KAAKmC,OAAOM,cACxBkC,KAAM3E,KAAK2E,OAEb3E,KAAKoE,SAAW,CAACC,KAAYrE,KAAKoE,UAClCpE,KAAK2E,KAAO,GACZ3E,KAAK0F,UAAW,QACV1F,KAAKmH,WAAU,KACnBnH,KAAKoH,gBAET,EACAA,WAAAA,GACEpH,KAAKmH,WAAU,KACb,MAAME,EAAKrH,KAAKsH,MAAMC,WAClBF,GACFA,EAAGG,eAAe,CAAEC,SAAU,WAE3BzH,KAAKsH,MAAMI,OAGhBC,YAAW,IAAM3H,KAAKsH,MAAMI,MAAME,SAAS,OAE/C,EACA,cAAM5B,CAAS6B,GACb,IAAK7H,KAAKuE,aAAaC,UAAYqD,EAAKpH,GAEtC,YADAqH,QAAQC,IAAI,8BAA+B/H,KAAKuE,aAAcsD,GAGhE7H,KAAK2F,qBAAsB,EAE3B,IAAIqC,EAAc,KAClB,IAAK,MAAM/F,KAAQjC,KAAK6B,MAAO,CAC7B,MAAMoG,EAAe,CAAChG,EAAKiG,SAAUjG,EAAKQ,eAC1C,GAAIwF,EAAaE,SAASnI,KAAKuE,aAAaC,UAAYyD,EAAaE,SAASN,EAAKpH,IAAK,CACtFuH,EAAc/F,EACd,KACF,CACF,CAEK+F,IACHA,EAAc,CACZvH,GAAI,GACJgC,cAAeoF,EAAKpH,GACpByH,SAAUlI,KAAKuE,aAAaC,gBAG1BxE,KAAKoC,WAAW4F,EACxB,EACA,gBAAM5F,CAAWH,GACVA,GAILjC,KAAKoE,SAAW,GAChBpE,KAAKmC,OAASF,EAEdjC,KAAKoE,eAAiB2C,EAAAA,GAAeqB,kBACjC,CAACnB,OAAQhF,EAAKxB,GAAI4H,aAAa,IAEnCrI,KAAKoH,eATHU,QAAQQ,KAAK,0BAUjB,EACAC,WAAAA,GACEvI,KAAKmC,YAASqE,CAChB,EACAhE,OAAAA,CAAQgG,GACN,OAAOxI,KAAKyG,SAASgC,IAAID,EAC3B,EACA,kBAAME,CAAaF,GACjB,MAAMG,QAAU5B,EAAAA,GAAe6B,WAAWJ,GAC1CG,EAAEjG,aAAeqE,EAAAA,GAAe8B,SAAS,CAACL,OAAOG,EAAElI,GAAImB,IAAI+G,EAAEG,aAC7D9I,KAAKyG,SAASsC,IAAIJ,EAAElI,GAAIkI,EAC1B,EACA,cAAMzD,GACJ,IAAKlF,KAAKmC,OAAQ,OAClB,MAAM6G,QAAqBjC,EAAAA,GAAeqB,kBACtC,CAACnB,OAAOjH,KAAKmC,OAAOF,KAAKxB,GAAI4H,aAAY,IAE7CrI,KAAKoE,SAAW,IAAIpE,KAAKoE,YAAa4E,EAAa5E,SACrD,GAEF,aAAM6E,GACJnB,QAAQC,IAAI,qBAAsB/H,KAAKsB,SAAS2E,MAChD6B,QAAQC,IAAI,2BAA4B/H,KAAKkJ,OAAOC,OAAOlC,QAE3DjH,KAAKuE,aAAewC,EAAAA,GAAeqC,wBAC7BpJ,KAAK0I,aAAa1I,KAAKuE,aAAaC,SAE1C,MAAM3C,QAAckF,EAAAA,GAAesC,UAAS,GAC5C,GAAqB,IAAjBxH,EAAMC,OAGR,OAFAgG,QAAQQ,KAAK,kCACbtI,KAAKyB,SAAU,GAIjB,IAAI6H,EAAa,KACjB,IAAK,MAAMrH,KAAQJ,QACX7B,KAAK0I,aAAazG,EAAKiG,gBACvBlI,KAAK0I,aAAazG,EAAKQ,eAEzBR,EAAKxB,KAAOT,KAAKkJ,OAAOC,OAAOlC,SACjCa,QAAQC,IAAI,cAAewB,KAAKC,UAAUvH,IAC1C6F,QAAQC,IAAI,oBAAqB9F,EAAKiG,SAAU,QAASjG,EAAKQ,eAC9D6G,EAAarH,GAEXA,EAAKiG,WAAalI,KAAKuE,aAAaC,WACrCvC,EAAKiG,SAAUjG,EAAKQ,eAAiB,CAACR,EAAKQ,cAAeR,EAAKiG,WAIpElI,KAAK6B,MAAQA,QACP7B,KAAKoC,WAAWkH,GACtBtJ,KAAKyB,SAAU,CACjB,G,UCzTF,MAAMgI,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O,4GCiBOhJ,MAAM,gC,GAGJA,MAAM,+B,GACJA,MAAM,uD,SAKQA,MAAM,qB,aAIhBA,MAAM,a,GACNA,MAAM,qB,GAMVA,MAAM,6BAA6BC,IAAI,oB,SACtBD,MAAM,uB,GAYjBA,MAAM,8B,GASZA,MAAM,qC,2IA1CfE,EAAAA,EAAAA,IAuDM,MAvDNC,EAuDM,EAtDJC,EAAAA,EAAAA,IAAWC,IAEXC,EAAAA,EAAAA,IAmDM,MAnDNC,EAmDM,EAlDJD,EAAAA,EAAAA,IAaM,MAbNE,EAaM,EAZJJ,EAAAA,EAAAA,IAEc6I,EAAA,CAFAC,GAAI,CAAA3D,KAAA,SAAmBvF,MAAM,Q,mBACzC,IAAmDU,EAAA,KAAAA,EAAA,KAAnDJ,EAAAA,EAAAA,IAAmD,KAAhDN,MAAM,uCAAqC,a,aAGrCgB,EAAAO,OAAI,WAAfrB,EAAAA,EAAAA,IAOM,MAPNmB,EAOM,EANJf,EAAAA,EAAAA,IAC2C,OADrCuB,IAAKb,EAAAiF,UAAUjE,QAAU,sBAC1BhC,MAAM,+B,WACXM,EAAAA,EAAAA,IAGM,aAFJA,EAAAA,EAAAA,IAAiD,IAAjDqB,GAAiDS,EAAAA,EAAAA,IAAzBpB,EAAAiF,UAAU5D,UAAQ,IAC1C/B,EAAAA,EAAAA,IAA0D,IAA1DsB,EAA6B,KAACQ,EAAAA,EAAAA,IAAGpB,EAAAO,KAAKQ,eAAa,2BAMzDzB,EAAAA,EAAAA,IAmBM,MAnBN6I,EAmBM,CAlBOnI,EAAAD,UAAO,WAAlBb,EAAAA,EAAAA,IAEM,MAFN+B,EAEM,EADJ7B,EAAAA,EAAAA,IAA6BU,EAAA,CAApBC,QAASC,EAAAD,SAAO,sCAIzBb,EAAAA,EAAAA,IAWMe,EAAAA,GAAA,CAAAC,IAAA,IAAAI,EAAAA,EAAAA,IAXiBN,EAAA0C,UAAXC,K,WAAZzD,EAAAA,EAAAA,IAWM,OAX4BgB,IAAKyC,EAAQ5D,GAC1CC,OAAKwB,EAAAA,EAAAA,IAAA,CAAC,YAAW,eACOmC,EAAQC,YAAc5C,EAAAoI,kB,EACjD9I,EAAAA,EAAAA,IAOM,OAPDN,OAAKwB,EAAAA,EAAAA,IAAA,CAAC,iCACEmC,EAAQC,YAAc5C,EAAAoI,cAAa,qC,uBAE9ClJ,EAAAA,EAAAA,IAAmC,4BAAnByD,EAAQM,MAAI,cAC5B3D,EAAAA,EAAAA,IAEI,IAFJ4B,GAEIE,EAAAA,EAAAA,IADCI,EAAAC,SAASC,QAAQiB,EAAQS,aAAU,c,aAQhD9D,EAAAA,EAAAA,IAWM,MAXN6B,EAWM,EAVJ7B,EAAAA,EAAAA,IASO,QATA+I,SAAM3I,EAAA,KAAAA,EAAA,IAAA4I,EAAAA,EAAAA,KAAA,IAAAxE,IAAUlE,EAAAmE,aAAAnE,EAAAmE,eAAAD,IAAW,cAAE9E,MAAM,Q,WACxCM,EAAAA,EAAAA,IAG0E,S,qCAH1DU,EAAAH,WAAUF,GACnB+D,KAAK,OACLC,YAAY,oBACZ3E,MAAM,4D,iBAHGgB,EAAAH,cAAU,aAI1BP,EAAAA,EAAAA,IAGS,UAHDoE,KAAK,SACL1E,MAAM,6CAA4C,UAE1D,c,uBAWV,GACEuF,KAAM,OACNC,WAAY,CACVC,SAASC,EAAAA,EAAAA,KAAqB,IAAM,gCACpCC,QAAQD,EAAAA,EAAAA,KAAqB,IAAM,iCAErCG,IAAAA,GACE,MAAO,CACL9E,SAAS,EACTQ,KAAM,KACNmC,SAAU,GACV7C,WAAY,GACZ0F,YAAQT,EACRsD,mBAAetD,EACfG,eAAWH,EAEf,EACAI,QAAS,CACP,cAAMqD,GACJ,IACEjK,KAAKiC,WAAa8E,EAAAA,GAAemD,QAAQ,CACvCjD,OAAQjH,KAAKiH,QAEjB,CAAE,MAAOhH,GACP6H,QAAQ7H,MAAM,sBAAuBA,EACvC,CACF,EAEA,kBAAMkK,GACJ,IACE,MAAM/F,QAAiB2C,EAAAA,GAAeqB,kBAClC,CAACnB,OAAOjH,KAAKiH,OAAQoB,aAAY,IAGrCrI,KAAKoE,SAAW,IAAIA,KAAapE,KAAKoE,SACxC,CAAE,MAAOnE,GACP6H,QAAQ7H,MAAM,0BAA2BA,EAC3C,CACF,EAEA,iBAAMwF,GACJ,GAAKzF,KAAKuB,WAAW6I,OAErB,IACE,MAAM/F,QAAgB0C,EAAAA,GAAeC,kBAAmB,CACtDC,OAAQjH,KAAKiH,OACbC,WAAYlH,KAAK2G,UAAUlG,GAC3BkE,KAAM3E,KAAKuB,aAEbvB,KAAKoE,SAAS0C,KAAKzC,GACnBrE,KAAKuB,WAAa,GAClBvB,KAAKqK,gBACP,CAAE,MAAOpK,GACP6H,QAAQ7H,MAAM,yBAA0BA,EAC1C,CACF,EAEAoK,cAAAA,GACErK,KAAKmH,WAAU,KACb,MAAMmD,EAAYtK,KAAKsH,MAAMiD,iBAC7BD,EAAUE,UAAYF,EAAUG,eAEpC,GAEF,aAAMxB,GACJnB,QAAQC,IAAI,qBAAsB/H,KAAKsB,SAAS2E,MAChDjG,KAAK8J,cAAgB9J,KAAKkJ,OAAOC,OAAO1I,GACxCT,KAAKiH,OAASjH,KAAKkJ,OAAOC,OAAOlC,aAE3ByD,QAAQC,IAAI,CAChB3K,KAAKiK,WACLjK,KAAKmK,iBAGHnK,KAAKiC,KAAKiG,WAAalI,KAAK8J,cAC9B9J,KAAK2G,gBAAkBI,EAAAA,GAAe6B,WAAW5I,KAAKiC,KAAKiG,UAE3DlI,KAAK2G,gBAAkBI,EAAAA,GAAe6B,WAAW5I,KAAKiC,KAAKQ,eAE7DzC,KAAK2G,UAAUjE,aAAeqE,EAAAA,GAAe8B,SAAS,CAACL,OAAOxI,KAAK2G,UAAUlG,GAAImB,IAAI5B,KAAK2G,UAAUmC,aACpG9I,KAAKyB,SAAU,EACfzB,KAAKqK,gBACP,G,UCnKF,MAAMZ,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O,kGCkBOjJ,GAAG,MAAMC,MAAM,gC,GACbA,MAAM,gC,GAGJA,MAAM,2F,GACJA,MAAM,0C,mBASsBA,MAAM,0D,aAU5BA,MAAM,kB,iBAGFA,MAAM,+B,wBAMNA,MAAM,mB,GACJA,MAAM,4B,GACNA,MAAM,iB,GACNA,MAAM,mD,GAGNA,MAAM,6B,GAIRA,MAAM,iB,gLA3C3BE,EAAAA,EAAAA,IAkEM,MAlENC,EAkEM,EAjEJG,EAAAA,EAAAA,IAgEM,MAhENC,EAgEM,EA/DJH,EAAAA,EAAAA,IAAWC,IAEXC,EAAAA,EAAAA,IA8CM,MA9CNE,EA8CM,EA7CJF,EAAAA,EAAAA,IAIM,MAJNe,EAIM,cAHJf,EAAAA,EAAAA,IAA+C,MAA3CN,MAAM,4BAA2B,SAAK,iBAC1CM,EAAAA,EAAAA,IAA2D,KAAxDN,MAAM,+CAA6C,WACtDM,EAAAA,EAAAA,IAA8F,KAA1FG,QAAKC,EAAA,KAAAA,EAAA,GAAAC,GAAEC,EAAAC,cAAcb,MAAM,gEAIjCI,EAAAA,EAAAA,IAA6BU,EAAA,CAApBC,QAASC,EAAAD,SAAO,oBACbC,EAAAD,S,iBAAO,WAAnBb,EAAAA,EAAAA,IAoCM,MAAAgK,EAAA,CAnCwB,IAAjBlJ,EAAAG,MAAMC,SAAM,WAAvBlB,EAAAA,EAAAA,IAOM,MAPNyB,EAOMjB,EAAA,KAAAA,EAAA,KANJJ,EAAAA,EAAAA,IAKM,OALDN,MAAM,mDAAiD,EAC1DM,EAAAA,EAAAA,IAA6C,KAA1CN,MAAM,qBAAoB,iBAC7BM,EAAAA,EAAAA,IAEI,KAFDN,MAAM,qBAAoB,8CAE7B,sCAGJE,EAAAA,EAAAA,IA0BMe,EAAAA,GAAA,MAAAK,EAAAA,EAAAA,IA1BcN,EAAAG,OAARI,K,WAAZrB,EAAAA,EAAAA,IA0BM,OA1BsBgB,IAAKK,EAAKxB,I,CACxBa,EAAAkB,QAAQP,EAAKQ,iBAAa,WAAtC7B,EAAAA,EAAAA,IAwBM,MAAA0B,EAAA,EAvBJtB,EAAAA,EAAAA,IAsBM,MAtBN6I,EAsBM,EArBJ7I,EAAAA,EAAAA,IAoBM,OApBDN,MAAM,8EACRS,QAAKE,GAAEC,EAAAc,WAAWH,I,EACnBjB,EAAAA,EAAAA,IAKM,MALN4B,EAKM,EAJJ5B,EAAAA,EAAAA,IAGI,KAHA6J,KAAI,KAAO5I,EAAKQ,iB,EAClBzB,EAAAA,EAAAA,IACiD,OAD3CuB,IAAKjB,EAAAkB,QAAQP,EAAKQ,eAAeC,QAAU,sBAC5ChC,MAAM,oC,mBAGfM,EAAAA,EAAAA,IAWM,MAXNiC,EAWM,EAVJjC,EAAAA,EAAAA,IAQM,MARNsC,EAQM,EAPJtC,EAAAA,EAAAA,IAAsF,IAAtFwC,GAAsFV,EAAAA,EAAAA,IAA1DxB,EAAAkB,QAAQP,EAAKQ,eAAeM,UAAY,aAAJ,IAChE/B,EAAAA,EAAAA,IAEI,IAFJyC,EAA2D,MACxDX,EAAAA,EAAAA,IAAGb,EAAKQ,eAAa,IAExBzB,EAAAA,EAAAA,IAEI,IAFJ0C,GAEIZ,EAAAA,EAAAA,IADCI,EAAAC,SAASC,QAAQnB,EAAK6I,eAAY,2BAGzClK,EAAAA,EAAAA,IAAoE,IAApE+C,EAAoE,mBAA9B1B,EAAKsB,cAAgB,IAAJ,+C,wBASrEvC,EAAAA,EAAAA,IAKM,OALDN,MAAM,qFAAmF,EAC5FM,EAAAA,EAAAA,IAGM,OAHDN,MAAM,eAAa,EACtBM,EAAAA,EAAAA,IAAsD,MAAlDN,MAAM,2BAA0B,kBACpCM,EAAAA,EAAAA,IAA0E,KAAvEN,MAAM,iBAAgB,qDAA6C,IAKlEgB,EAAAiE,sBAAmB,WAD3BC,EAAAA,EAAAA,IAKEC,EAAA,C,MAHQF,oBAAqBjE,EAAAiE,oB,8CAAAjE,EAAAiE,oBAAmBtE,GAC/CyE,UAAWpE,EAAAoE,UACXC,WAAUzE,EAAA0E,U,mFA/DmD1E,EAAA4D,SAAR,W,sCAyE9D,GACEe,KAAM,QACNC,WAAY,CACVI,mBAAmBF,EAAAA,EAAAA,KAAqB,IAAM,gCAC9CC,QAAQD,EAAAA,EAAAA,KAAqB,IAAM,gCACnCD,SAASC,EAAAA,EAAAA,KAAqB,IAAM,iCAEtCG,IAAAA,GACE,MAAO,CACL9E,SAAS,EACTkE,qBAAqB,EACrB9D,MAAO,GACPiE,UAAW,GACXW,SAAU,IAAIC,IACdC,eAAWH,EAEf,EACAI,QAAS,CACPrF,UAAAA,GACEvB,KAAK2F,qBAAsB,CAC7B,EACA,gBAAMvD,CAAWH,GACVA,GAA2B,IAAnBA,EAAKxB,GAAGqB,SAGrBgG,QAAQC,IAAI,gBACZ/H,KAAK6G,QAAQC,KAAK,CAChBb,KAAM,WACNkD,OAAQ,CACN1I,GAAIT,KAAKkJ,OAAOC,OAAO1I,GACvBwG,OAAQhF,EAAKxB,MAGnB,EACA,cAAMuF,CAAS6B,GAEb,GADAC,QAAQC,IAAI,eACPF,GAA2B,IAAnBA,EAAKpH,GAAGqB,OACnB,OAEF9B,KAAK2F,qBAAsB,EAG3B,MAAMoF,EAAe/K,KAAK6B,MAAM/B,MAC9BkL,GAAQA,EAAKvI,gBAAkBoF,EAAKpH,KAGtC,GAAIsK,EAEF,kBADM/K,KAAKoC,WAAW2I,GAIxB,MAAME,QAAgBlE,EAAAA,GAAemE,WAAWrD,EAAKpH,UAC/CT,KAAKoC,WAAW6I,EACxB,EACAzI,OAAAA,CAAQgG,GACN,OAAOxI,KAAKyG,SAASgC,IAAID,EAC3B,EACA,kBAAME,CAAaF,GACjB,IAAKA,GAA4B,IAAlBA,EAAO1G,OACpB,OAGF,MAAM6G,QAAU5B,EAAAA,GAAe6B,WAAWJ,GAC1CG,EAAEjG,aAAeqE,EAAAA,GAAe8B,SAAS,CAACL,OAAOG,EAAElI,GAAImB,IAAI+G,EAAEG,aAC7D9I,KAAKyG,SAASsC,IAAIJ,EAAElI,GAAIkI,GACxBb,QAAQC,IAAI,WAAY/H,KAAKyG,SAC/B,EACA,cAAMvB,GACJ,MAAMrD,QAAckF,EAAAA,GAAesC,UAAS,GAC5C,IAAK,MAAMpH,KAAQJ,QACX7B,KAAK0I,aAAazG,EAAKQ,qBACvBzC,KAAK0I,aAAazG,EAAKiG,UAE/BlI,KAAK6B,MAAQ,IAAI7B,KAAK6B,SAAUA,EAClC,GAGF,aAAMoH,GACFnB,QAAQC,IAAI,qBAAsB/H,KAAKsB,SAAS2E,MAChDjG,KAAK8F,UAAY9F,KAAKkJ,OAAOC,OAAO1I,SAC9BT,KAAK0I,aAAa1I,KAAK8F,WAE7B,MAAMjE,QAAckF,EAAAA,GAAesC,UAAS,GAE5C,IAAK,MAAMpH,KAAQJ,QACX7B,KAAK0I,aAAazG,EAAKiG,gBACvBlI,KAAK0I,aAAazG,EAAKQ,eAEzBR,EAAKiG,WAAalI,KAAK8F,aACxB7D,EAAKiG,SAAUjG,EAAKQ,eAAiB,CAACR,EAAKQ,cAAeR,EAAKiG,WAGpElI,KAAK6B,MAAQA,EACb7B,KAAKyB,SAAU,CACjB,G,UC3LJ,MAAMgI,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://warpnet-frontend/./node_modules/core-js/modules/es.iterator.find.js","webpack://warpnet-frontend/./src/views/Messages.vue","webpack://warpnet-frontend/./src/views/Messages.vue?2e03","webpack://warpnet-frontend/./src/views/Conversation.vue","webpack://warpnet-frontend/./src/views/Conversation.vue?e9cd","webpack://warpnet-frontend/./src/views/Conversations.vue","webpack://warpnet-frontend/./src/views/Conversations.vue?b98d"],"sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar iteratorClose = require('../internals/iterator-close');\nvar iteratorHelperWithoutClosingOnEarlyError = require('../internals/iterator-helper-without-closing-on-early-error');\n\nvar findWithoutClosingOnEarlyError = iteratorHelperWithoutClosingOnEarlyError('find', TypeError);\n\n// `Iterator.prototype.find` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.find\n$({ target: 'Iterator', proto: true, real: true, forced: findWithoutClosingOnEarlyError }, {\n  find: function find(predicate) {\n    anObject(this);\n    try {\n      aCallable(predicate);\n    } catch (error) {\n      iteratorClose(this, 'throw', error);\n    }\n\n    if (findWithoutClosingOnEarlyError) return call(findWithoutClosingOnEarlyError, this, predicate);\n\n    var record = getIteratorDirect(this);\n    var counter = 0;\n    return iterate(record, function (value, stop) {\n      if (predicate(value, counter++)) return stop(value);\n    }, { IS_RECORD: true, INTERRUPTED: true }).result;\n  }\n});\n","<!-- License generated by licensor(https://github.com/Marvin9/licensor).\n\nWarpnet - Decentralized Social Network\nCopyright (C) 2025 Vadim Filin, https://github.com/Warp-net,\n<github.com.mecdy@passmail.net>\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU Affero General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Affero General Public License for more details.\n\nYou should have received a copy of the GNU Affero General Public License\nalong with this program.  If not, see <https://www.gnu.org/licenses/>.\n\nWarpNet is provided “as is” without warranty of any kind, either expressed or implied.\nUse at your own risk. The maintainers shall not be liable for any damages or data loss\nresulting from the use or misuse of this software.\n-->\n<template>\n  <div id=\"app\" class=\"flex h-full w-full\">\n    <!-- Sidebar -->\n    <SideNav />\n\n    <!-- Chats list (center column) -->\n    <div class=\"hidden md:flex flex-col w-1/3 h-full overflow-y-scroll border-r border-lighter\">\n      <div class=\"px-5 py-3 border-b border-lighter flex items-center\">\n        <h1 class=\"text-xl font-bold flex-1\">Chats</h1>\n        <i class=\"fas fa-cog text-xl text-blue cursor-pointer\"></i>\n        <i @click=\"newMessage()\" class=\"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer\"></i>\n      </div>\n\n      <Loader :loading=\"loading\" />\n\n      <template v-if=\"!loading\">\n        <div v-if=\"chats.length === 0\" class=\"flex flex-col items-center justify-center pt-10\">\n          <p class=\"font-bold text-lg\">No chats yet</p>\n          <p class=\"text-sm text-dark\">Wait until someone starts a chat here.</p>\n        </div>\n\n        <div v-for=\"chat in chats\" :key=\"chat.id\"\n             class=\"cursor-pointer\"\n             :class=\"chat.id === active?.id ? 'border-r-2 border-blue' : ''\"\n             @click=\"selectChat(chat)\">\n          <div class=\"flex items-start px-4 py-2 hover:bg-lightest border-b\">\n            <div class=\"mr-4\">\n              <img\n                  :src=\"getUser(chat.other_user_id)?.avatar || 'default_profile.png'\"\n                  class=\"h-12 w-12 rounded-full\"\n              />\n            </div>\n            <div class=\"w-full truncate\">\n              <div class=\"flex items-center\">\n                <p class=\"font-semibold truncate\">{{ getUser(chat.other_user_id)?.username || 'Anonymous' }}</p>\n                <p class=\"text-sm text-dark ml-2 truncate hidden md:block\">\n                  @{{ chat.other_user_id }}\n                </p>\n                <p class=\"text-sm text-dark ml-auto\">\n                  {{ $filters.timeago(chat.updated_at) }}\n                </p>\n              </div>\n              <p class=\"text-sm truncate\" v-linkify>{{ chat.last_message || '' }}</p>\n            </div>\n          </div>\n        </div>\n      </template>\n    </div>\n\n    <!-- Placeholder (right column, if no active chat selected) -->\n    <div v-if=\"loading || !active\" class=\"flex flex-col w-full md:w-2/3 h-full items-center justify-center\">\n      <div class=\"w-3/5 text-center\">\n        <p class=\"font-bold text-lg\">You don’t have a message selected</p>\n        <p class=\"text-sm text-dark mt-2\">\n          This is where you’ll see messages from people you don’t follow.\n        </p>\n        <button\n            @click=\"newMessage()\"\n            class=\"mt-5 h-10 px-4 text-white font-semibold bg-blue hover:bg-darkblue rounded-full\"\n        >\n          New Message\n        </button>\n      </div>\n    </div>\n\n    <!-- Messages view -->\n    <div v-if=\"!loading && active\" class=\"flex flex-col w-full md:w-2/3 h-full\">\n      <!-- Top bar -->\n      <div class=\"flex items-center px-5 py-2 border-b border-lighter bg-white sticky top-0\">\n        <button @click=\"gotoHome()\" class=\"block md:hidden mr-2 focus:outline-none\">\n          <i class=\"fas fa-arrow-left text-blue\"></i>\n        </button>\n        <div class=\"mr-4\">\n          <img\n              :src=\"getUser(active.other_user_id)?.avatar || 'default_profile.png'\"\n              class=\"w-6 h-6 rounded-full\"\n          />\n        </div>\n        <div class=\"flex flex-col\">\n          <h1 class=\"font-bold\">{{ getUser(active.other_user_id)?.username }}</h1>\n          <p class=\"text-xs text-dark\">@{{ active.other_user_id }}</p>\n        </div>\n        <i class=\"fas fa-info-circle ml-auto text-xl text-blue cursor-pointer\"></i>\n      </div>\n\n      <!-- Messages -->\n      <div class=\"flex-1 overflow-y-scroll px-5 pt-5 no-scrollbar\" v-scroll:top=\"loadMore\">\n        <div class=\"flex flex-col-reverse\">\n          <div ref=\"scrollToMe\"></div>\n          <div v-for=\"message in messages\" :key=\"message.id\">\n            <!-- Own message -->\n            <div v-if=\"message.sender_id === ownerProfile.user_id\" class=\"flex justify-end mb-4\">\n              <div class=\"bg-blue text-white py-2 px-4 rounded-tl-3xl rounded-bl-3xl rounded-tr-xl\">\n                {{ message.text }}\n              </div>\n              <p class=\"text-xs text-dark ml-2\">{{ $filters.time(message.created_at) }}</p>\n            </div>\n            <!-- Incoming message -->\n            <div v-else class=\"flex items-start mb-4\">\n              <img\n                  :src=\"getUser(active.other_user_id)?.avatar || 'default_profile.png'\"\n                  class=\"h-8 w-8 rounded-full mr-2\"\n              />\n              <div class=\"bg-lighter text-black py-2 px-4 rounded-tr-3xl rounded-tl-xl rounded-br-3xl\">\n                {{ message.text }}\n              </div>\n              <p class=\"text-xs text-dark ml-2\">{{ $filters.time(message.created_at) }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Input -->\n      <div class=\"px-5 py-3 border-t border-lighter flex items-center bg-white\">\n        <input\n            v-model=\"text\"\n            type=\"search\"\n            class=\"flex-1 px-4 py-2 rounded-full bg-lighter focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue text-sm\"\n            placeholder=\"Start a new message\"\n            @keyup.enter=\"sendMessage\"\n            :disabled=\"disabled\"\n        />\n        <button\n            @click=\"sendMessage\"\n            :disabled=\"disabled || !text.length\"\n            class=\"ml-4 w-8 h-8 rounded-full focus:outline-none\"\n            :class=\"text.length === 0 ? 'opacity-50 cursor-default' : 'hover:bg-lightblue'\"\n        >\n          <i class=\"fas fa-arrow-right text-blue text-xl\"></i>\n        </button>\n      </div>\n    </div>\n\n    <!-- New message overlay -->\n    <NewMessageOverlay\n        :profileId=\"active?.other_user_id\"\n        v-if=\"showNewMessageModal\"\n        v-model:showNewMessageModal=\"showNewMessageModal\"\n        @selected=\"selected\"\n    />\n  </div>\n</template>\n\n\n<script>\nimport {defineAsyncComponent} from \"vue\";\nimport {warpnetService} from \"@/service/service\";\n\nexport default {\n  name: \"Messages\",\n  components: {\n    SideNav: defineAsyncComponent(() => import('@/components/SideNav.vue')),\n    Loader: defineAsyncComponent(() => import('@/components/Loader.vue')),\n    NewMessageOverlay: defineAsyncComponent(() => import('@/components/NewMessageOverlay.vue')),\n  },\n  data() {\n    return {\n      loading: true,\n      disabled: false,\n      showNewMessageModal: false,\n      chats: [],\n      messages: [],\n      ownerProfile: undefined,\n      active: undefined,\n      text: '',\n      usersMap: new Map(),\n      otherUser: undefined,\n    };\n  },\n  methods: {\n    newMessage() {\n      this.showNewMessageModal = true;\n    },\n    gotoHome() {\n      this.$router.push({\n        name: \"Home\",\n      });\n    },\n    async sendMessage() {\n      if (!this.active.other_user_id || this.text.length === 0) return;\n      this.disabled = true; // disable message input temporarily\n\n      const message = await warpnetService.sendDirectMessage({\n        chatId: this.active.id,\n        receiverId: this.active.other_user_id,\n        text: this.text,\n      })\n      this.messages = [message, ...this.messages]\n      this.text = \"\";\n      this.disabled = false;\n      await this.$nextTick(() => {\n        this.scrollToEnd();\n      });\n    },\n    scrollToEnd() {\n      this.$nextTick(() => {\n        const el = this.$refs.scrollToMe;\n        if (el) {\n          el.scrollIntoView({ behavior: \"smooth\" });\n        }\n        if (!this.$refs.input) {\n          return\n        }\n        setTimeout(() => this.$refs.input.focus(), 500);\n      });\n    },\n    async selected(user) {\n      if (!this.ownerProfile.user_id || !user.id) {\n        console.log(\"messages: no selected(user)\", this.ownerProfile, user)\n        return;\n      }\n      this.showNewMessageModal = false;\n\n      let currentChat = null\n      for (const chat of this.chats) {\n        const participants = [chat.owner_id, chat.other_user_id];\n        if (participants.includes(this.ownerProfile.user_id) && participants.includes(user.id)) {\n          currentChat = chat;\n          break;\n        }\n      }\n\n      if (!currentChat) {\n        currentChat = {\n          id: \"\",\n          other_user_id: user.id,\n          owner_id: this.ownerProfile.user_id,\n        };\n      }\n      await this.selectChat(currentChat);\n    },\n    async selectChat(chat) {\n      if (!chat) {\n        console.warn(\"no active chat selected\")\n        return\n      }\n      this.messages = []; // reset messages\n      this.active = chat;\n\n      this.messages = await warpnetService.getDirectMessages(\n          {chatId: chat.id, cursorReset: true},\n      );\n      this.scrollToEnd();\n    },\n    deselectAll() {\n      this.active = undefined;\n    },\n    getUser(userId) {\n      return this.usersMap.get(userId);\n    },\n    async loadChatUser(userId) {\n      const u = await warpnetService.getProfile(userId)\n      u.avatar = await warpnetService.getImage({userId:u.id, key:u.avatar_key})\n      this.usersMap.set(u.id, u)\n    },\n    async loadMore() {\n      if (!this.active) return;\n      const messagesResp = await warpnetService.getDirectMessages(\n          {chatId:this.active.chat.id, cursorReset:false},\n      )\n      this.messages = [...this.messages, ...messagesResp.messages];\n    },\n  },\n  async created() {\n    console.log(\"loading component:\", this.$options.name);\n    console.log(\"messages: route chat id:\", this.$route.params.chatId)\n\n    this.ownerProfile = warpnetService.getOwnerProfile()\n    await this.loadChatUser(this.ownerProfile.user_id)\n\n    const chats = await warpnetService.getChats(true)\n    if (chats.length === 0) {\n      console.warn(\"messages: chats not found\")\n      this.loading = false;\n      return;\n    }\n\n    let activeChat = null\n    for (const chat of chats) {\n      await this.loadChatUser(chat.owner_id)\n      await this.loadChatUser(chat.other_user_id)\n\n      if (chat.id === this.$route.params.chatId) {\n        console.log('ACTIVE CHAT', JSON.stringify(chat))\n        console.log('ACTIVE CHAT owner', chat.owner_id, \"other\", chat.other_user_id)\n        activeChat = chat\n      }\n      if (chat.owner_id !== this.ownerProfile.user_id) {\n        [chat.owner_id, chat.other_user_id] = [chat.other_user_id, chat.owner_id];\n      }\n    }\n\n    this.chats = chats;\n    await this.selectChat(activeChat);\n    this.loading = false;\n  },\n};\n</script>\n","import { render } from \"./Messages.vue?vue&type=template&id=07b4a53d\"\nimport script from \"./Messages.vue?vue&type=script&lang=js\"\nexport * from \"./Messages.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!-- License generated by licensor(https://github.com/Marvin9/licensor).\n\nWarpnet - Decentralized Social Network\nCopyright (C) 2025 Vadim Filin, https://github.com/Warp-net,\n<github.com.mecdy@passmail.net>\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU Affero General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Affero General Public License for more details.\n\nYou should have received a copy of the GNU Affero General Public License\nalong with this program.  If not, see <https://www.gnu.org/licenses/>.\n\nWarpNet is provided “as is” without warranty of any kind, either expressed or implied.\nUse at your own risk. The maintainers shall not be liable for any damages or data loss\nresulting from the use or misuse of this software.\n-->\n<template>\n  <div class=\"flex container h-full w-full\">\n    <SideNav />\n    \n    <div class=\"flex-1 flex flex-col h-full\">\n      <div class=\"px-4 py-3 border-b border-lighter flex items-center\">\n        <router-link :to=\"{ name: 'Chats' }\" class=\"mr-4\">\n          <i class=\"fas fa-arrow-left text-xl text-blue\"></i>\n        </router-link>\n        \n        <div v-if=\"chat\" class=\"flex items-center\">\n          <img :src=\"otherUser.avatar || 'default_profile.png'\"\n               class=\"w-10 h-10 rounded-full mr-3\" />\n          <div>\n            <p class=\"font-bold\">{{ otherUser.username }}</p>\n            <p class=\"text-sm text-dark\">@{{ chat.other_user_id }}</p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Messages -->\n      <div class=\"flex-1 overflow-y-auto p-4\" ref=\"messageContainer\">\n        <div v-if=\"loading\" class=\"flex justify-center\">\n          <Loader :loading=\"loading\" />\n        </div>\n\n        <template v-else>\n          <div v-for=\"message in messages\" :key=\"message.id\" \n               class=\"mb-4 flex\"\n               :class=\"{'justify-end': message.sender_id === currentUserId}\">\n            <div class=\"max-w-3/4 rounded-lg px-4 py-2\"\n                 :class=\"message.sender_id === currentUserId ?\n                        'bg-blue text-white' : 'bg-lighter'\">\n              <p v-linkify>{{ message.text }}</p>\n              <p class=\"text-xs mt-1 text-gray-500\">\n                {{ $filters.timeago(message.created_at) }}\n              </p>\n            </div>\n          </div>\n        </template>\n      </div>\n\n      <!-- Message Input -->\n      <div class=\"border-t border-lighter px-4 py-3\">\n        <form @submit.prevent=\"sendMessage\" class=\"flex\">\n          <input v-model=\"newMessage\" \n                 type=\"text\"\n                 placeholder=\"Type a message...\"\n                 class=\"flex-1 rounded-full border border-lighter px-4 py-2 mr-2\" />\n          <button type=\"submit\" \n                  class=\"bg-blue text-white rounded-full px-6 py-2\">\n            Send\n          </button>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {defineAsyncComponent} from \"vue\";\nimport {warpnetService} from \"@/service/service\";\n\nexport default {\n  name: 'Chat',\n  components: {\n    SideNav: defineAsyncComponent(() => import('../components/SideNav.vue')),\n    Loader: defineAsyncComponent(() => import('../components/Loader.vue')),\n  },\n  data() {\n    return {\n      loading: true,\n      chat: null,\n      messages: [],\n      newMessage: '',\n      chatId: undefined,\n      currentUserId: undefined,\n      otherUser: undefined,\n    };\n  },\n  methods: {\n    async loadChat() {\n      try {\n        this.chat = await warpnetService.getChat({\n          chatId: this.chatId\n        });\n      } catch (error) {\n        console.error('Error loading chat:', error);\n      }\n    },\n\n    async loadMessages() {\n      try {\n        const messages = await warpnetService.getDirectMessages(\n            {chatId:this.chatId, cursorReset:true},\n        );\n\n        this.messages = [...messages, ...this.messages];\n      } catch (error) {\n        console.error('Error loading messages:', error);\n      }\n    },\n\n    async sendMessage() {\n      if (!this.newMessage.trim()) return;\n\n      try {\n        const message = await warpnetService.sendDirectMessage( {\n          chatId: this.chatId,\n          receiverId: this.otherUser.id,\n          text: this.newMessage,\n        });\n        this.messages.push(message);\n        this.newMessage = '';\n        this.scrollToBottom();\n      } catch (error) {\n        console.error('Error sending message:', error);\n      }\n    },\n\n    scrollToBottom() {\n      this.$nextTick(() => {\n        const container = this.$refs.messageContainer;\n        container.scrollTop = container.scrollHeight;\n      });\n    }\n  },\n  async created() {\n    console.log(\"loading component:\", this.$options.name);\n    this.currentUserId = this.$route.params.id;\n    this.chatId = this.$route.params.chatId;\n\n    await Promise.all([\n      this.loadChat(),\n      this.loadMessages()\n    ]);\n\n    if (this.chat.owner_id !== this.currentUserId) {\n      this.otherUser = await warpnetService.getProfile(this.chat.owner_id)\n    } else {\n      this.otherUser = await warpnetService.getProfile(this.chat.other_user_id)\n    }\n    this.otherUser.avatar = await warpnetService.getImage({userId:this.otherUser.id, key:this.otherUser.avatar_key})\n    this.loading = false;\n    this.scrollToBottom();\n  }\n};\n</script>","import { render } from \"./Conversation.vue?vue&type=template&id=125a634c\"\nimport script from \"./Conversation.vue?vue&type=script&lang=js\"\nexport * from \"./Conversation.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!-- License generated by licensor(https://github.com/Marvin9/licensor).\n\nWarpnet - Decentralized Social Network\nCopyright (C) 2025 Vadim Filin, https://github.com/Warp-net,\n<github.com.mecdy@passmail.net>\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU Affero General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Affero General Public License for more details.\n\nYou should have received a copy of the GNU Affero General Public License\nalong with this program.  If not, see <https://www.gnu.org/licenses/>.\n\nWarpNet is provided “as is” without warranty of any kind, either expressed or implied.\nUse at your own risk. The maintainers shall not be liable for any damages or data loss\nresulting from the use or misuse of this software.\n-->\n\n<template>\n  <div id=\"app\" class=\"flex container h-full w-full\" v-scroll:bottom=\"loadMore\">\n    <div class=\"flex container h-full w-full\">\n      <SideNav />\n\n      <div class=\"w-full sm:w-1/3 md:w-1/2 lg:w-1/2 h-full overflow-y-scroll no-scrollbar hidden md:block\">\n        <div class=\"px-5 py-3 border-b border-lighter flex\">\n          <h1 class=\"text-xl font-bold flex-1\">Chats</h1>\n          <i class=\"fas fa-cog text-xl text-blue cursor-pointer\"></i>\n          <i @click=\"newMessage()\" class=\"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer\"></i>\n        </div>\n\n        <!-- chats -->\n        <Loader :loading=\"loading\" />\n        <div v-if=\"!loading\">\n          <div v-if=\"chats.length === 0\" class=\"flex flex-col items-center justify-center w-full pt-10\">\n            <div class=\"w-1/2 flex flex-col items-center justify-center\">\n              <p class=\"font-bold text-lg\">No chats yet</p>\n              <p class=\"text-sm text-dark\">\n                Wait until someone starts a chat here.\n              </p>\n            </div>\n          </div>\n          <div v-for=\"chat in chats\" :key=\"chat.id\">\n            <div v-if=\"(getUser(chat.other_user_id))\">\n              <div class=\"cursor-pointer\">\n                <div class=\"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex\"\n                  @click=\"selectChat(chat)\">\n                  <div class=\"flex-none mr-2 md:mr-4 pt-1\">\n                    <a :href=\"`#/${chat.other_user_id}`\">\n                      <img :src=\"getUser(chat.other_user_id).avatar || 'default_profile.png'\"\n                           class=\"flex-none w-12 h-12 rounded-full\"  />\n                    </a>\n                  </div>\n                  <div class=\"w-full truncate\">\n                    <div class=\"flex items-center w-full\">\n                      <p class=\"font-semibold\">{{ getUser(chat.other_user_id).username || 'Anonymous' }}</p>\n                      <p class=\"hidden md:block text-sm text-dark ml-2 truncate\">\n                        @{{ chat.other_user_id }}\n                      </p>\n                      <p class=\"text-sm text-dark ml-auto\">\n                        {{ $filters.timeago(chat.lastModified) }}\n                      </p>\n                    </div>\n                    <p class=\"pb-2 truncate\" v-linkify>{{ chat.last_message || \"\" }}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"w-full border-l border-r border-lighter h-screen flex items-center justify-center\">\n        <div class=\"text-center\">\n          <h2 class=\"text-2xl font-bold mb-4\">Select a chat</h2>\n          <p class=\"text-gray-600\">Choose a chat from the list to start chatting</p>\n        </div>\n      </div>\n\n      <NewMessageOverlay\n        v-if=\"showNewMessageModal\"\n        v-model:showNewMessageModal=\"showNewMessageModal\"\n        :profileId=\"profileId\"\n        @selected=\"selected\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport {defineAsyncComponent} from \"vue\";\nimport {warpnetService} from \"@/service/service\";\n\nexport default {\n  name: \"Chats\",\n  components: {\n    NewMessageOverlay: defineAsyncComponent(() => import('../components/NewMessageOverlay.vue')),\n    Loader: defineAsyncComponent(() => import('../components/Loader.vue')),\n    SideNav: defineAsyncComponent(() => import('../components/SideNav.vue')),\n  },\n  data() {\n    return {\n      loading: true,\n      showNewMessageModal: false,\n      chats: [],\n      profileId: \"\",\n      usersMap: new Map(),\n      otherUser: undefined,\n    };\n  },\n  methods: {\n    newMessage() {\n      this.showNewMessageModal = true;\n    },\n    async selectChat(chat) {\n      if (!chat || chat.id.length === 0) {\n        return\n      }\n      console.log('selectChat()')\n      this.$router.push({\n        name: 'Messages',\n        params: {\n          id: this.$route.params.id,\n          chatId: chat.id,\n        },\n      });\n    },\n    async selected(user) {\n      console.log('selected()')\n      if (!user || user.id.length === 0) {\n        return;\n      }\n      this.showNewMessageModal = false;\n\n      // Check if chat already exists\n      const existingChat = this.chats.find(\n        conv => conv.other_user_id === user.id\n      );\n\n      if (existingChat) {\n        await this.selectChat(existingChat);\n        return;\n      }\n      // Create new chat\n      const newChat = await warpnetService.createChat(user.id);\n      await this.selectChat(newChat);\n    },\n    getUser(userId) {\n      return this.usersMap.get(userId);\n    },\n    async loadChatUser(userId) {\n      if (!userId || userId.length === 0) {\n        return\n      }\n\n      const u = await warpnetService.getProfile(userId)\n      u.avatar = await warpnetService.getImage({userId:u.id, key:u.avatar_key})\n      this.usersMap.set(u.id, u)\n      console.log('usersMap', this.usersMap)\n    },\n    async loadMore() {\n      const chats = await warpnetService.getChats(false);\n      for (const chat of chats) {\n        await this.loadChatUser(chat.other_user_id)\n        await this.loadChatUser(chat.owner_id)\n      }\n      this.chats = [...this.chats, ...chats];\n    },\n  },\n\n  async created() {\n      console.log(\"loading component:\", this.$options.name);\n      this.profileId = this.$route.params.id\n      await this.loadChatUser(this.profileId)\n\n      const chats = await warpnetService.getChats(true);\n\n      for (const chat of chats) {\n        await this.loadChatUser(chat.owner_id)\n        await this.loadChatUser(chat.other_user_id)\n\n        if (chat.owner_id !== this.profileId) {\n          [chat.owner_id, chat.other_user_id] = [chat.other_user_id, chat.owner_id];\n        }\n      }\n      this.chats = chats;\n      this.loading = false;\n    }\n};\n</script>\n","import { render } from \"./Conversations.vue?vue&type=template&id=ca0b36a4\"\nimport script from \"./Conversations.vue?vue&type=script&lang=js\"\nexport * from \"./Conversations.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["$","call","iterate","aCallable","anObject","getIteratorDirect","iteratorClose","iteratorHelperWithoutClosingOnEarlyError","findWithoutClosingOnEarlyError","TypeError","target","proto","real","forced","find","predicate","this","error","record","counter","value","stop","IS_RECORD","INTERRUPTED","result","id","class","ref","_createElementBlock","_hoisted_1","_createVNode","_component_SideNav","_createElementVNode","_hoisted_2","_hoisted_3","onClick","_cache","$event","$options","newMessage","_component_Loader","loading","$data","_Fragment","key","chats","length","_hoisted_4","_renderList","chat","_normalizeClass","active","selectChat","_hoisted_6","_hoisted_7","src","getUser","other_user_id","avatar","_hoisted_9","_hoisted_10","_hoisted_11","_toDisplayString","username","_hoisted_12","_hoisted_13","_ctx","$filters","timeago","updated_at","_hoisted_14","last_message","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","gotoHome","_hoisted_19","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","messages","message","sender_id","ownerProfile","user_id","_hoisted_27","_hoisted_28","text","_hoisted_29","time","created_at","_hoisted_30","_hoisted_32","_hoisted_33","loadMore","_hoisted_34","type","placeholder","onKeyup","_withKeys","args","sendMessage","disabled","showNewMessageModal","_createBlock","_component_NewMessageOverlay","profileId","onSelected","selected","name","components","SideNav","defineAsyncComponent","Loader","NewMessageOverlay","data","undefined","usersMap","Map","otherUser","methods","$router","push","warpnetService","sendDirectMessage","chatId","receiverId","$nextTick","scrollToEnd","el","$refs","scrollToMe","scrollIntoView","behavior","input","setTimeout","focus","user","console","log","currentChat","participants","owner_id","includes","getDirectMessages","cursorReset","warn","deselectAll","userId","get","loadChatUser","u","getProfile","getImage","avatar_key","set","messagesResp","created","$route","params","getOwnerProfile","getChats","activeChat","JSON","stringify","__exports__","render","_component_router_link","to","_hoisted_8","currentUserId","onSubmit","_withModifiers","loadChat","getChat","loadMessages","trim","scrollToBottom","container","messageContainer","scrollTop","scrollHeight","Promise","all","_hoisted_5","href","lastModified","existingChat","conv","newChat","createChat"],"sourceRoot":""}