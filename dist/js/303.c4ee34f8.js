"use strict";(self["webpackChunkwarpnet_frontend"]=self["webpackChunkwarpnet_frontend"]||[]).push([[303],{4303:function(e,t,i){i.r(t),i.d(t,{default:function(){return Q}});var s=i(641),r=i(33);const l={key:0},a={class:"pt-4 pl-4 flex flex-row"},o={class:"text-sm text-dark"},w={class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex"},d={class:"flex-none mr-2 md:mr-4 pt-1"},n=["src"],h={class:"w-full"},u={class:"flex items-center w-full"},p={class:"font-semibold"},c={class:"hidden md:block text-sm text-dark ml-2"},k={class:"text-sm text-dark ml-2"},f={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1"},m={key:0,class:"pb-2"},y={key:1,class:"pb-2 bg-red-300"},g={key:2,class:"mt-2"},v=["src"],_={class:"flex w-full"},x={class:"flex items-center text-sm text-dark w-1/4"},C={key:0},L={class:"flex items-center text-sm text-dark w-1/4"},b={key:0},R={class:"flex items-center text-sm text-dark w-1/4"},T={key:0};function I(e,t,i,I,O,X){const $=(0,s.g2)("ReplyOverlay");return(0,s.uX)(),(0,s.CE)(s.FK,null,[i.tweet.retweeted_by&&""!==i.tweet.retweeted_by?((0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",a,[t[7]||(t[7]=(0,s.Lk)("div",{class:"w-12 mr-4 flex justify-end"},[(0,s.Lk)("i",{class:"text-sm pt-1 fas fa-retweet text-dark"})],-1)),(0,s.Lk)("p",o,(0,r.v_)(O.label),1)])])):(0,s.Q3)("",!0),(0,s.Lk)("div",w,[(0,s.Lk)("div",d,[(0,s.Lk)("a",null,[(0,s.Lk)("img",{src:`${this.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,n)])]),(0,s.Lk)("div",h,[(0,s.Lk)("div",u,[(0,s.Lk)("a",{onClick:t[0]||(t[0]=e=>X.gotoProfile(i.tweet.user_id))},[(0,s.Lk)("p",p,(0,r.v_)(i.tweet.username||"Anonymous"),1)]),(0,s.Lk)("p",c," @"+(0,r.v_)(i.tweet.user_id),1),t[8]||(t[8]=(0,s.Lk)("p",{class:"text-sm text-dark ml-2"},"Â·",-1)),(0,s.Lk)("p",k,(0,r.v_)(e.$filters.timeago(i.tweet.created_at)),1),(0,s.Lk)("div",null,[(0,s.Lk)("i",{onClick:t[1]||(t[1]=e=>O.showDropdown=!O.showDropdown),class:"fas fa-angle-down text-sm ml-auto text-dark cursor-pointer"}),O.showDropdown?((0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("a",{onClick:t[2]||(t[2]=(...e)=>X.deleteTweet&&X.deleteTweet(...e)),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},"Delete tweet")])):(0,s.Q3)("",!0)])]),!i.tweet.moderation||i.tweet.moderation.is_ok?((0,s.uX)(),(0,s.CE)("p",m,(0,r.v_)(i.tweet.text),1)):((0,s.uX)(),(0,s.CE)("p",y," Moderated: "+(0,r.v_)(i.tweet.moderation.reason)+". ",1)),i.tweet.image?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("img",{src:i.tweet.image,alt:"Tweet image",class:"rounded-lg max-w-full border border-lighter"},null,8,v)])):(0,s.Q3)("",!0),(0,s.Lk)("div",_,[(0,s.Lk)("div",x,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>X.replyToTweet&&X.replyToTweet(...e)),class:"mr-2 rounded-full hover:bg-lighter"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"far fa-comment"},null,-1)])),X.getRepliesCount(i.tweet.id)>0?((0,s.uX)(),(0,s.CE)("p",C,(0,r.v_)(X.getRepliesCount(i.tweet.id)||"?"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",L,[(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>X.retweet()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,s.Lk)("i",{class:(0,r.C4)("fas fa-retweet "+(i.tweet.retweeted_by?"text-green-500":""))},null,2)]),X.getRetweetsCount(i.tweet.id)>0?((0,s.uX)(),(0,s.CE)("p",b,(0,r.v_)(X.getRetweetsCount(i.tweet.id)||"?"),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",R,[(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>X.like()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,s.Lk)("i",{class:(0,r.C4)("fas fa-heart "+(X.getLikesCount(i.tweet.id)>0?"text-red-600":""))},null,2)]),X.getLikesCount(i.tweet.id)>0?((0,s.uX)(),(0,s.CE)("p",T,(0,r.v_)(X.getLikesCount(i.tweet.id)),1)):(0,s.Q3)("",!0)]),t[10]||(t[10]=(0,s.Lk)("div",{class:"flex items-center text-sm text-dark w-1/4"},[(0,s.Lk)("i",{class:"fas fa-share-square mr-3 cursor-not-allowed"})],-1))])]),O.showReplyOverlay?((0,s.uX)(),(0,s.Wv)($,{key:0,tweet:i.tweet,profile:O.profile,showReplyOverlay:O.showReplyOverlay,onClose:t[6]||(t[6]=e=>O.showReplyOverlay=!1)},null,8,["tweet","profile","showReplyOverlay"])):(0,s.Q3)("",!0)])],64)}i(4114);var O=i(1787),X={name:"Tweet",props:["tweet"],components:{ReplyOverlay:(0,s.$V)((()=>i.e(646).then(i.bind(i,4646))))},data(){return{profile:{},showReplyOverlay:!1,showDropdown:!1,label:"You Retweeted",likesCount:new Map,retweetsCount:new Map,repliesCount:new Map}},methods:{gotoProfile(e){this.$router.push({name:"Profile",params:{id:e}})},async get(){let e;if(this.tweet.parent_id&&this.tweet.parent_id!==this.tweet.root_id){const t={rootId:this.tweet.root_id,replyId:this.tweet.id};e=await O.n.getReply(t)}else{const t={userId:this.tweet.user_id,tweetId:this.tweet.id};e=await O.n.getTweet(t)}this.showReplyOverlay=!0},async deleteTweet(){if(this.tweet.parent_id&&""!==this.tweet.parent_id){const e={userId:this.profile.id,rootId:this.tweet.root_id,replyId:this.tweet.id};await O.n.deleteReply(e)}else{const e={userId:this.tweet.user_id,tweetId:this.tweet.id};await O.n.deleteTweet(e),this.gotoProfile(this.profile.id)}},replyToTweet(){this.showReplyOverlay=!0},async retweet(){let e=0;const t={tweetId:this.tweet.id,userId:this.tweet.user_id,username:this.tweet.username,text:this.tweet.text},i=await O.n.hasRetweeter(this.tweet.id,this.profile.id);try{e=i&&""!==this.tweet.retweeted_by?await O.n.unretweetTweet(this.tweet.id).catch((e=>{console.error(`failed to unretweet [${this.tweet.id}]`,e)})):await O.n.retweetTweet(t).catch((e=>{console.error(`failed to retweet [${this.tweet.id}]`,e)}))}catch(s){return console.error(`failed to retweet/unretweet tweet [${this.tweet.id}]`,s),void await this.loadTweetStats(this.tweet.id,this.tweet.user_id)}i?await O.n.deleteRetweeter(this.tweet.id,this.profile.id):await O.n.setRetweeter(this.tweet.id,this.profile.id,this.profile),this.retweetsCount.set(this.tweet.id,e)},async like(){if("warpnet"!==this.tweet.network)return;let e=0;const t=await O.n.hasLiker(this.tweet.id,this.profile.id);try{e=t?await O.n.unlikeTweet(this.tweet.id,this.tweet.user_id):await O.n.likeTweet(this.tweet.id,this.tweet.user_id)}catch(i){return console.error(`failed to like/unlike tweet [${this.tweet.id}]`,i),void await this.loadTweetStats(this.tweet.id,this.tweet.user_id)}t?await O.n.deleteLiker(this.tweet.id,this.profile.id):await O.n.setLiker(this.tweet.id,this.profile.id,this.profile),this.likesCount.set(this.tweet.id,e)},getLikesCount(e){return this.likesCount.get(e)},getRetweetsCount(e){return this.retweetsCount.get(e)},getRepliesCount(e){return this.repliesCount.get(e)},async loadTweetStats(e,t){const i=await O.n.getTweetStats(e,t);this.likesCount.set(i.tweet_id,i.likes_count),this.retweetsCount.set(i.tweet_id,i.retweets_count),this.repliesCount.set(i.tweet_id,i.replies_count)}},async created(){if(console.log("loading component:",this.$options.name),this.profile=await O.n.getProfile(this.tweet.user_id),this.tweet.retweeted_by&&this.tweet.retweeted_by!==this.profile.id){const e=await O.n.getProfile(this.tweet.retweeted_by);this.label=`${e.username} Retweeted`}this.tweet.image=await O.n.getImage({userId:this.tweet.user_id,key:this.tweet.image_key}),this.profile.avatar=await O.n.getImage({userId:this.profile.id,key:this.profile.avatar_key}),await this.loadTweetStats(this.tweet.id,this.tweet.user_id)}},$=i(6262);const E=(0,$.A)(X,[["render",I]]);var Q=E}}]);
//# sourceMappingURL=303.c4ee34f8.js.map